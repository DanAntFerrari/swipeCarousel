
/* =========================================================
 * [carousel.min.js]
 * Project:       swipeCarousel_1.0.0
 * Description:   javascript assets
 * Last change:   03/12/2015 04:55:39 pm
 * Copyright:     2014 Wip Italia S.r.l.
 * Author URI:    http://www.wipitalia.it/
 * ========================================================= *
 * this file is minimized and inport by script.html include
 * ========================================================= */
   ;(function($,mzr,doc,win){"use strict";$.swipeCarousel=function(ele,options){if('undefined'===typeof ele)throw new Error('You must give an self.$ele');var self={};self.__class__='swipeCarousel';self.__version__='2.0.0';self.$ele=$(ele);self.$ele.data("swipeCarousel",self.$ele);self.defaults={slideshow:{state:false,timerInt:5000,stopLoop:3},set:{forRow:1,arrow:false,arrowTo:false,key:true,spot:false,spotTo:false,drag:true,gap:1,mode:"slide",timeTo:800,resize:true},callbacks:{onInit:null,beforeSet:null,afterSet:null,endSlideshow:null}};self.opt=$.extend(true,{},self.defaults,options);self.$container=$(">ul",self.$ele);self.$panes=$(">ul>li",self.$ele);var $win=$(win);var _paneWidth=0;var _paneHeight=0;var _paneCount=self.$panes.length;var _currentPane=0;var _isIE=document.all&&document.compatMode;var _slideTimer=null;var _moving=false;var _indicatorsNum=_paneCount;if(self.opt.set.forRow>=2)_indicatorsNum=_indicatorsNum-(self.opt.set.forRow-1);if(self.opt.set.arrow==true&&typeof self.opt.set.arrowTo==='string')self.opt.set.arrowTo=self.$ele.parents(self.opt.set.arrowTo);else if(!(self.opt.set.arrowTo instanceof $))self.opt.set.arrowTo=self.$ele;if(self.opt.set.spot==true&&typeof self.opt.set.spotTo==='string')self.opt.set.spotTo=self.$ele.parents(self.opt.set.spotTo);else if(!(self.opt.set.spotTo instanceof $))self.opt.set.spotTo=self.$ele;self.setPaneDimensions=function(onInitI){if(self.opt.callbacks.beforeSet!=null&&typeof(self.opt.callbacks.beforeSet)=='function')self.opt.callbacks.afterSet(self);self.$container.addClass('hidden');if(self.opt.set.arrow&&self.$navArrow)self.$navArrow.addClass('invisible');if(self.opt.set.spot&&self.$indicators)self.$indicators.addClass('invisible');self.$ele.addClass('js-loading');self.$ele.removeAttr('style');_paneWidth=Math.ceil((self.$ele.innerWidth())/self.opt.set.forRow*10000)/10000;self.$panes.width(_paneWidth);var _containerWidth=_paneWidth*(_paneCount);if(self.opt.set.mode=="fade"){self.panesHeight=self.$panes.height();_containerWidth=self.$ele.width;self.$panes.hide();self.$panes.css({position:"absolute",top:0,left:0});self.$container.height(self.panesHeight);}
self.$panes.eq(_currentPane).addClass('active');if(_currentPane!=0)self.$panes.eq(_currentPane-1).addClass('prev');self.$panes.eq(_currentPane+1).addClass('next');if(self.opt.set.spot&&self.$indicators){var leftMargin=self.$indicators.outerWidth()/2;self.$indicators.css('margin-left',-leftMargin+'px');}
self.$ele.animate({width:self.$ele.innerWidth()},0,function(){self.$container.animate({width:_containerWidth},0,function(){self.$ele.removeClass('js-loading');if(self.opt.set.arrow&&self.$navArrow)self.$navArrow.removeClass('invisible');if(self.opt.set.spot&&self.$indicators)self.$indicators.removeClass('invisible');self.$container.delay(100).removeClass('hidden');if(onInitI){if(self.opt.set.forRow>=2){self.$panes.slice(0,(0+self.opt.set.forRow)).fadeIn(self.opt.set.timeTo);}
else{self.$panes.eq(0).fadeIn(self.opt.set.timeTo);}
onInitI=false;if(self.opt.callbacks.onInit!=null&&typeof(self.opt.callbacks.onInit)=='function')self.opt.callbacks.onInit(self);}
else{self.goToIndex(_currentPane);}
if(self.opt.callbacks.afterSet!=null&&typeof(self.opt.callbacks.afterSet)=='function')self.opt.callbacks.afterSet(self);});});};self.navigation=function(){if(self.opt.set.arrow||self.opt.set.key||self.opt.set.spot)self.opt.set.arrowTo.addClass('withnav');if(self.opt.set.arrow){var left="<a class='disabled nav-arrow prev disable' disabled='disabled' rel='prev' href='javascript:void(0);'> <span aria-hidden='true' class='icon-arrow-left'></span></a>";var right="<a class='nav-arrow next' rel='next' href='javascript:void(0);'><span aria-hidden='true' class='icon-arrow-right'></span></a>";$(right).appendTo(self.opt.set.arrowTo);$(left).prependTo(self.opt.set.arrowTo);self.$navArrow=self.opt.set.arrowTo.find('.nav-arrow');self.$navArrowNext=self.opt.set.arrowTo.find('.next');self.$navArrowPrev=self.opt.set.arrowTo.find('.prev');self.opt.set.arrowTo.on('click','.nav-arrow',function(e,simulated){if(!simulated){clearInterval(_slideTimer);}
if($(this).hasClass('prev')){self.prev();}
else{self.next();}});}
if(self.opt.set.spot){var indicatorsHtml="<ul class='indicators'>";for(var i=0;i<_indicatorsNum;i++){$(this).data('ind','ind_'+i);indicatorsHtml+='<li class="spot" data-index="'+i+'"><a href="javascript:void(0);"></a></li>';}
indicatorsHtml+="</ul>";$(indicatorsHtml).appendTo(self.opt.set.spotTo);self.$indicators=self.opt.set.spotTo.find('.indicators');self.$indicatorSpot=self.opt.set.spotTo.find('.indicators li');self.$indicatorSpot.eq(_currentPane).addClass('active');self.opt.set.spotTo.on('click','.spot',function(e,simulated){if(!simulated){clearInterval(_slideTimer);}
var item=$(this).data('index');if(_moving==false){self.goToIndex(item);}});}};self.sliderstartTimer=function(){var slideCounter=1,i_slide=1,i_loop=1;if(slideCounter<_paneCount){_slideTimer=setInterval(function(){if(slideCounter==_paneCount){self.goToIndex(0);if(self.opt.slideshow.stopLoop==i_loop){clearInterval(_slideTimer);if(self.opt.callbacks.endSlideshow!=null&&typeof(self.opt.callbacks.endSlideshow)=='function')self.opt.callbacks.endSlideshow(self);}
else{slideCounter=1;}
i_loop++}
else{self.goToIndex(slideCounter);slideCounter++;}
i_slide++},self.opt.slideshow.timerInt);}};self.showPane=function(index,animate){index=Math.max(0,Math.min(index,_paneCount-1));if(self.opt.set.mode=="fade"){var old__currentPane=_currentPane;if(self.opt.set.forRow>=2){self.$panes.stop();self.$panes.slice(old__currentPane,(old__currentPane+self.opt.set.forRow)).hide();self.$indicatorSpot.eq(index).addClass('active');self.$panes.slice(index,(index+self.opt.set.forRow)).fadeIn(self.opt.set.timeTo,function(){_currentPane=index;_moving=false;});}
else{self.$panes.stop();self.$panes.hide();self.$indicatorSpot.eq(index).addClass('active');self.$panes.eq(index).fadeIn(self.opt.set.timeTo,function(){_currentPane=index;_moving=false;});}}
else{_currentPane=index;var offset=-((100/_paneCount)*_currentPane);if((self.opt.set.lastgap!=null)&&((index+1)>=_paneCount)){console.log("ultimo",offset,self.opt.set.lastgap);offset=offset+Number(self.opt.set.lastgap);}
setContainerOffset(offset,true);self.$panes.eq(_currentPane).addClass('active');if(_currentPane!=0)self.$panes.eq(_currentPane-1).addClass('prev');self.$panes.eq(_currentPane+1).addClass('next');if(self.$indicatorSpot)self.$indicatorSpot.eq(_currentPane).addClass('active');}};function setContainerOffset(percent,animate){self.$container.removeClass("animate");self.opt.set.arrowTo.removeClass("animate");if(animate){self.$container.addClass("animate");self.opt.set.arrowTo.addClass("animate");}
if(!_isIE&&Modernizr.csstransforms3d){self.$container.css("transform","translate3d("+percent+"%,0,0) scale3d(1,1,1)");}
else if(!_isIE&&Modernizr.csstransforms){self.$container.css("transform","translate("+percent+"%,0)");}
else{var px=((_paneWidth*_paneCount)/100)*percent;if(TweenMax)TweenMax.to(self.$container,0.8,{css:{marginLeft:px},ease:Expo.easeOut});else self.$container.animate({marginLeft:px},800);}}
self.next=function(){self.updatenav(_currentPane,'next');if(_currentPane<(_indicatorsNum-1)){return self.showPane(_currentPane+1,true);}};self.prev=function(){self.updatenav(_currentPane,'prev');if(_currentPane>0){return self.showPane(_currentPane-1,true);}};self.goToIndex=function(index){self.updatenav(_currentPane,index);return self.showPane(index,true);};self.updatenav=function(index,direction){if(self.opt.set.arrow&&self.$navArrow)self.$navArrow.removeClass('disabled').removeAttr('disabled');if(self.opt.set.spot&&self.$indicatorSpot)self.$indicatorSpot.removeClass('active');self.$panes.eq(_currentPane).removeClass('active');self.$panes.removeClass('prev next');switch(direction){case'prev':if(_currentPane<=1){if(self.opt.set.arrow)self.$navArrowPrev.addClass('disabled').attr('disabled','disabled');}
break;case'next':if(_currentPane>=(_indicatorsNum-1)&&self.opt.set.arrow){self.$navArrowNext.addClass('disabled').attr('disabled','disabled');}
break;default:if(direction==0){if(self.opt.set.arrow)self.$navArrowPrev.addClass('disabled').attr('disabled','disabled');}
else if(direction==(_paneCount-1)){if(self.opt.set.arrow)self.$navArrowNext.addClass('disabled').attr('disabled','disabled');}
break;}};function handleHammer(ev,simulated){if(!simulated){clearInterval(_slideTimer);}
switch(ev.type){case'dragright':case'dragleft':ev.gesture.preventDefault();if(self.opt.set.mode!="fade"){if((_currentPane!=0&&ev.gesture.direction==Hammer.DIRECTION_RIGHT)||(_currentPane!=_indicatorsNum-1==ev.gesture.direction==Hammer.DIRECTION_LEFT)){var pane_offset=-(100/_paneCount)*_currentPane;var drag_offset=((100/_paneWidth)*ev.gesture.deltaX)/_paneCount;if((_currentPane==0&&ev.gesture.direction==Hammer.DIRECTION_RIGHT)||(_currentPane==_indicatorsNum-1&&ev.gesture.direction==Hammer.DIRECTION_LEFT)){drag_offset*=.4;}
if(ev.gesture.deltaX<=_paneWidth&&ev.gesture.direction==Hammer.DIRECTION_RIGHT||(ev.gesture.deltaX>=(-_paneWidth))&&ev.gesture.direction==Hammer.DIRECTION_LEFT){setContainerOffset(drag_offset+pane_offset);}}}
break;case'swipeleft':ev.gesture.preventDefault();self.next();ev.gesture.stopDetect();break;case'swiperight':ev.gesture.preventDefault();self.prev();ev.gesture.stopDetect();break;case'release':if(Math.abs(ev.gesture.deltaX)>_paneWidth/2){if(ev.gesture.direction=='right'){self.prev();}
else{self.next();}}
else{self.showPane(_currentPane,true);}
var h=$('body').scrollTop();var hgap=ev.gesture.deltaY;if(ev.gesture.direction=='up'||ev.gesture.direction=='down'){$('html,body').animate({scrollTop:h-(hgap*3)},'500');}
break;}}
self.init=function(){if(_paneCount>self.opt.set.forRow)self.navigation();else self.opt.set.arrow=self.opt.set.arrow=false;self.setPaneDimensions(true);if(_paneCount>self.opt.set.forRow&&self.opt.slideshow.state)self.sliderstartTimer();if(self.opt.set.resize){$win.on("resize orientationchange",function(){clearInterval(_slideTimer);self.setPaneDimensions(false);});}};self.init();if(_paneCount>self.opt.set.forRow&&self.opt.set.drag&&Hammer&&!_isIE){self.$ele.hammer().on("release dragleft dragright swipeleft swiperight",handleHammer);};return self;};$.fn.swipeCarousel=function(options){return this.each(function(){(new $.swipeCarousel(this,options));});};})(jQuery,Modernizr,document,window);